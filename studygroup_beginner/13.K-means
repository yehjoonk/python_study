{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Cluster Analysis (군집분석)\n",
    "\n",
    "비지도학습(Unsupervised Learning)에 속하는 머신러닝 기법.\n",
    "\n",
    "- eg: pattern recognition, image analysis, bioinformatics, customer segmentation\n",
    "\n",
    "### K-Means Clustering Algorithm\n",
    "n개의 data와 k개라는 class 갯수가 주어졌을때, 각각의 class들에 속한 점들간의 분산을 최소화하는게 k-clustering의 목적입니다. 즉, 근처에 있는 data들끼리 모아서 하나의 class로 선언하는 방식입니다.\n",
    "\n",
    "![Random Unsplash Image](https://www.ncbi.nlm.nih.gov/books/NBK543520/bin/463627_1_En_9_Fig4_HTML.jpg)\n",
    "\n",
    "k-means 알고리즘은 cluster의 중심이 되는 cluster centroid를 임의로 k개 만큼 선정하고, 각 점으로부터 거리를 계산하여 모든 data의 Class를 할당, 모든 Class들의 무게중심으로 centroid를 이동, 다시 각 점으로부터의 거리를 계싼하여 class할당... 을 반복하는 알고리즘입니다. 이후 cluster centeroid가 최적의 위치로 이동하게 되면, 더이상 이동하지 않으며, 그때 iteration을 종료하게됩니다. \n",
    "\n",
    "\n",
    "\n",
    "\n",
    "- 참고영상: https://www.youtube.com/watch?v=YIGtalP1mv0\n",
    "\n",
    "- 데이터 출처: https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python\n",
    "\n",
    "\n",
    "#### Pros \n",
    "\n",
    "- 쉽고 간편한 연산\n",
    "- 큰 데이터셋에 적응가능(scalable)\n",
    "- 패턴이 뚜렷하지 않은 데이터에도 적용 가능\n",
    "\n",
    "#### Cons\n",
    "\n",
    "- k 값을 임의로 정해야 함\n",
    "- outlier에 민감함"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Import & Explore Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CustomerID</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Annual Income (k$)</th>\n",
       "      <th>Spending Score (1-100)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Male</td>\n",
       "      <td>19</td>\n",
       "      <td>15</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Male</td>\n",
       "      <td>21</td>\n",
       "      <td>15</td>\n",
       "      <td>81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Female</td>\n",
       "      <td>20</td>\n",
       "      <td>16</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>16</td>\n",
       "      <td>77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Female</td>\n",
       "      <td>31</td>\n",
       "      <td>17</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   CustomerID  Gender  Age  Annual Income (k$)  Spending Score (1-100)\n",
       "0           1    Male   19                  15                      39\n",
       "1           2    Male   21                  15                      81\n",
       "2           3  Female   20                  16                       6\n",
       "3           4  Female   23                  16                      77\n",
       "4           5  Female   31                  17                      40"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#import data\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "df = pd.read_csv(\"Mall_Customers.csv\")\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 데이터 클리닝 할 때 유용한것들 몇가지\n",
    "- df.shape : 크기확인\n",
    "- df.renmae(columns = {'old_name' : 'new_name'}) : columns 이름 바꿔주기\n",
    "- df.stypes : 데이터 타입 확인\n",
    "- df.describe() : 각 컬럼의 데이터를 요약해서 보여줌\n",
    "- df.isnull().sum() : null 값 확인\n",
    "- df.dropna(how = \"all\") : 모든 null값 삭제 \n",
    "- df.columnname.unique() : unique 한 값들 보여줌\n",
    "- len(df.columnname.unique()) : 해당 컬럼에 unique 한 값이 몇개인지 확인 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>annual_income</th>\n",
       "      <th>spending_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Male</td>\n",
       "      <td>19</td>\n",
       "      <td>15</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Male</td>\n",
       "      <td>21</td>\n",
       "      <td>15</td>\n",
       "      <td>81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Female</td>\n",
       "      <td>20</td>\n",
       "      <td>16</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Female</td>\n",
       "      <td>23</td>\n",
       "      <td>16</td>\n",
       "      <td>77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Female</td>\n",
       "      <td>31</td>\n",
       "      <td>17</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id  gender  age  annual_income  spending_score\n",
       "0   1    Male   19             15              39\n",
       "1   2    Male   21             15              81\n",
       "2   3  Female   20             16               6\n",
       "3   4  Female   23             16              77\n",
       "4   5  Female   31             17              40"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.rename(columns = {'CustomerID' : 'id', 'Gender': 'gender', 'Age' : 'age', 'Annual Income (k$)':'annual_income', 'Spending Score (1-100)': 'spending_score'}, inplace = True)\n",
    "df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "70\n",
      "50.2\n"
     ]
    }
   ],
   "source": [
    "print(df['age'].max())\n",
    "print(df['spending_score'].mean())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(200, 5)"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id                 int64\n",
       "gender            object\n",
       "age                int64\n",
       "annual_income      int64\n",
       "spending_score     int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>age</th>\n",
       "      <th>annual_income</th>\n",
       "      <th>spending_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>200.000000</td>\n",
       "      <td>200.000000</td>\n",
       "      <td>200.000000</td>\n",
       "      <td>200.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>100.500000</td>\n",
       "      <td>38.850000</td>\n",
       "      <td>60.560000</td>\n",
       "      <td>50.200000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>57.879185</td>\n",
       "      <td>13.969007</td>\n",
       "      <td>26.264721</td>\n",
       "      <td>25.823522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>15.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>50.750000</td>\n",
       "      <td>28.750000</td>\n",
       "      <td>41.500000</td>\n",
       "      <td>34.750000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>100.500000</td>\n",
       "      <td>36.000000</td>\n",
       "      <td>61.500000</td>\n",
       "      <td>50.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>150.250000</td>\n",
       "      <td>49.000000</td>\n",
       "      <td>78.000000</td>\n",
       "      <td>73.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>200.000000</td>\n",
       "      <td>70.000000</td>\n",
       "      <td>137.000000</td>\n",
       "      <td>99.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id         age  annual_income  spending_score\n",
       "count  200.000000  200.000000     200.000000      200.000000\n",
       "mean   100.500000   38.850000      60.560000       50.200000\n",
       "std     57.879185   13.969007      26.264721       25.823522\n",
       "min      1.000000   18.000000      15.000000        1.000000\n",
       "25%     50.750000   28.750000      41.500000       34.750000\n",
       "50%    100.500000   36.000000      61.500000       50.000000\n",
       "75%    150.250000   49.000000      78.000000       73.000000\n",
       "max    200.000000   70.000000     137.000000       99.000000"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id                0\n",
       "gender            0\n",
       "age               0\n",
       "annual_income     0\n",
       "spending_score    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()\n",
    "\n",
    "#만약 null 값이 있으면, df = df.dropna(how='all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Male', 'Female'], dtype=object)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.gender.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "200"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df.id.unique())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Groupby\n",
    "\n",
    "* 공식문서: https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Female</td>\n",
       "      <td>112</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Male</td>\n",
       "      <td>88</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   gender   id\n",
       "0  Female  112\n",
       "1    Male   88"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# group customers by 'gender',\n",
    "# and count the number of customers in each group. \n",
    "\n",
    "df2 = df.groupby('gender').id.count().reset_index()\n",
    "df2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Female</td>\n",
       "      <td>38.098214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Male</td>\n",
       "      <td>39.806818</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   gender        age\n",
       "0  Female  38.098214\n",
       "1    Male  39.806818"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# group customers by 'gender', \n",
    "# and calculate the average age per gender using mean() method.\n",
    "\n",
    "df3 = df.groupby('gender').age.mean().reset_index()\n",
    "df3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>annual_income</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Female</td>\n",
       "      <td>18</td>\n",
       "      <td>65.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Female</td>\n",
       "      <td>19</td>\n",
       "      <td>64.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Female</td>\n",
       "      <td>20</td>\n",
       "      <td>26.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Female</td>\n",
       "      <td>21</td>\n",
       "      <td>44.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>22</td>\n",
       "      <td>37.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82</th>\n",
       "      <td>Male</td>\n",
       "      <td>66</td>\n",
       "      <td>63.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>83</th>\n",
       "      <td>Male</td>\n",
       "      <td>67</td>\n",
       "      <td>45.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84</th>\n",
       "      <td>Male</td>\n",
       "      <td>68</td>\n",
       "      <td>63.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>Male</td>\n",
       "      <td>69</td>\n",
       "      <td>44.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>Male</td>\n",
       "      <td>70</td>\n",
       "      <td>47.50</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>87 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    gender  age  annual_income\n",
       "0   Female   18          65.00\n",
       "1   Female   19          64.00\n",
       "2   Female   20          26.50\n",
       "3   Female   21          44.75\n",
       "4   Female   22          37.00\n",
       "..     ...  ...            ...\n",
       "82    Male   66          63.00\n",
       "83    Male   67          45.00\n",
       "84    Male   68          63.00\n",
       "85    Male   69          44.00\n",
       "86    Male   70          47.50\n",
       "\n",
       "[87 rows x 3 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# group customers by 'gender' and 'age',  \n",
    "# and calculate the average annual income using mean() method.\n",
    "\n",
    "df4 = df.groupby(['gender', 'age']).annual_income.mean().reset_index()\n",
    "df4"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### One Hot Encoding\n",
    "\n",
    "기계가 읽어들일수 없는 값들(Categorical Variables)을 1과 0의 숫자로 변환하는 과정\n",
    "\n",
    "- **pd.get_dummies(df, coulmns = ['column_name'])**\n",
    "\n",
    "![Random Unsplash Image](https://miro.medium.com/max/1400/1*O_pTwOZZLYZabRjw3Ga21A.png)\n",
    "\n",
    "\n",
    "- 공식문서: https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html\n",
    "- 참고용 블로그: https://blog.naver.com/oys0608/222324158962"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>age</th>\n",
       "      <th>annual_income</th>\n",
       "      <th>spending_score</th>\n",
       "      <th>gender_Female</th>\n",
       "      <th>gender_Male</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>19</td>\n",
       "      <td>15</td>\n",
       "      <td>39</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "      <td>15</td>\n",
       "      <td>81</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>20</td>\n",
       "      <td>16</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>23</td>\n",
       "      <td>16</td>\n",
       "      <td>77</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>31</td>\n",
       "      <td>17</td>\n",
       "      <td>40</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id  age  annual_income  spending_score  gender_Female  gender_Male\n",
       "0   1   19             15              39              0            1\n",
       "1   2   21             15              81              0            1\n",
       "2   3   20             16               6              1            0\n",
       "3   4   23             16              77              1            0\n",
       "4   5   31             17              40              1            0"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.get_dummies(df, columns = ['gender'])\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Normalisation \n",
    "\n",
    "분석 전에 데이터를 정규화(normalization)하여 데이터의 스케일을 0과 1사이로 맞춰주는 작업. \n",
    "\n",
    "![Random Unsplash Image](https://i2.wp.com/cmdlinetips.com/wp-content/uploads/2020/06/Quantile_Normalization_in_Python.png?w=379&ssl=1)\n",
    "\n",
    "![Random Unsplash Image](https://i0.wp.com/cmdlinetips.com/wp-content/uploads/2020/06/Boxplot_after_Quantile_Normalization_Seaborn.png?w=603&ssl=1)\n",
    "\n",
    "* sklearn.preprocessing 라이브러리의 MinMaxScaler 클래스 이용. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import MinMaxScaler\n",
    "\n",
    "scaler = MinMaxScaler()\n",
    "df[ : ] = scaler.fit_transform(df[ : ])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>age</th>\n",
       "      <th>annual_income</th>\n",
       "      <th>spending_score</th>\n",
       "      <th>gender_Female</th>\n",
       "      <th>gender_Male</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.019231</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.387755</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.005025</td>\n",
       "      <td>0.057692</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.816327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.010050</td>\n",
       "      <td>0.038462</td>\n",
       "      <td>0.008197</td>\n",
       "      <td>0.051020</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.015075</td>\n",
       "      <td>0.096154</td>\n",
       "      <td>0.008197</td>\n",
       "      <td>0.775510</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.020101</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.016393</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>195</th>\n",
       "      <td>0.979899</td>\n",
       "      <td>0.326923</td>\n",
       "      <td>0.860656</td>\n",
       "      <td>0.795918</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>0.984925</td>\n",
       "      <td>0.519231</td>\n",
       "      <td>0.909836</td>\n",
       "      <td>0.275510</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>0.989950</td>\n",
       "      <td>0.269231</td>\n",
       "      <td>0.909836</td>\n",
       "      <td>0.744898</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>198</th>\n",
       "      <td>0.994975</td>\n",
       "      <td>0.269231</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.173469</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.230769</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.836735</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>200 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           id       age  annual_income  spending_score  gender_Female  \\\n",
       "0    0.000000  0.019231       0.000000        0.387755            0.0   \n",
       "1    0.005025  0.057692       0.000000        0.816327            0.0   \n",
       "2    0.010050  0.038462       0.008197        0.051020            1.0   \n",
       "3    0.015075  0.096154       0.008197        0.775510            1.0   \n",
       "4    0.020101  0.250000       0.016393        0.397959            1.0   \n",
       "..        ...       ...            ...             ...            ...   \n",
       "195  0.979899  0.326923       0.860656        0.795918            1.0   \n",
       "196  0.984925  0.519231       0.909836        0.275510            1.0   \n",
       "197  0.989950  0.269231       0.909836        0.744898            0.0   \n",
       "198  0.994975  0.269231       1.000000        0.173469            0.0   \n",
       "199  1.000000  0.230769       1.000000        0.836735            0.0   \n",
       "\n",
       "     gender_Male  \n",
       "0            1.0  \n",
       "1            1.0  \n",
       "2            0.0  \n",
       "3            0.0  \n",
       "4            0.0  \n",
       "..           ...  \n",
       "195          0.0  \n",
       "196          0.0  \n",
       "197          1.0  \n",
       "198          1.0  \n",
       "199          1.0  \n",
       "\n",
       "[200 rows x 6 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Customer Segmentation with K-Means Clustering "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.cluster import KMeans\n",
    "\n",
    "# WCSS (Within-Cluster-Sum-of-Squares  is the sum of squares of the distances of each data point in all clusters to their respective centroids.)\n",
    "\n",
    "wcss = []\n",
    "for i in range(1,11):\n",
    "    kmeans = KMeans(n_clusters = i, init = 'k-means++', random_state = 42)\n",
    "    kmeans.fit(df)\n",
    "    wcss.append(kmeans.inertia_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 720x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "plt.figure(figsize = (10,8))\n",
    "plt.plot(range(1, 11), wcss, marker = 'o', linestyle = '--')\n",
    "plt.xlabel('Number of Clusters')\n",
    "plt.ylabel('WCSS')\n",
    "plt.title('K-means Clustering')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "# We run K-means with a fixed number of clusters. In our case 2.\n",
    "kmeans = KMeans(n_clusters = 2, init = 'k-means++', random_state = 42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "KMeans(n_clusters=2, random_state=42)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kmeans.fit(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_segm_kmeans = df.copy()\n",
    "df_segm_kmeans['Segment K-means'] = kmeans.labels_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>age</th>\n",
       "      <th>annual_income</th>\n",
       "      <th>spending_score</th>\n",
       "      <th>gender_Female</th>\n",
       "      <th>gender_Male</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Segment K-means</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.518787</td>\n",
       "      <td>0.419362</td>\n",
       "      <td>0.387109</td>\n",
       "      <td>0.484810</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.485239</td>\n",
       "      <td>0.386504</td>\n",
       "      <td>0.362705</td>\n",
       "      <td>0.515579</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       id       age  annual_income  spending_score  \\\n",
       "Segment K-means                                                      \n",
       "0                0.518787  0.419362       0.387109        0.484810   \n",
       "1                0.485239  0.386504       0.362705        0.515579   \n",
       "\n",
       "                 gender_Female  gender_Male  \n",
       "Segment K-means                              \n",
       "0                          0.0          1.0  \n",
       "1                          1.0          0.0  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_segm_analysis = df_segm_kmeans.groupby(['Segment K-means']).mean()\n",
    "df_segm_analysis"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
